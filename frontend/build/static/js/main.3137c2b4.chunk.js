(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t){},105:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(45),o=a.n(r),i=a(52),c=a(3),l=a(4),m=a(6),u=a(5),d=a(7),h=a(1),g=a(22),p=a.n(g),f=function(e){return s.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block btn-large",disabled:e.disabled},e.children)},b=function(e){var t=e.currentUser===e.username?"Me":null;return s.a.createElement("div",{className:"message",style:t?{marginLeft:"70px"}:{}},s.a.createElement("div",{className:"message-username",style:t?{background:"#ccc",borderRight:"2px solid #FFC42D"}:{}},t||e.username),s.a.createElement("div",{className:"message-text"},e.text))},w=function(e){return s.a.createElement("div",{className:"message-list"},e.messageData.map(function(t,a){return s.a.createElement(b,{key:a,text:t.chat,username:t.name,currentUser:e.currentUser})}))},v=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(u.a)(t).call(this))).state={roomName:""},e.submitHandle=function(t){t.preventDefault(),e.props.addRoom(e.state.roomName),e.setState({roomName:""})},e.changeHandle=function(t){e.setState({roomName:t.target.value})},e.submitHandle=e.submitHandle.bind(Object(h.a)(Object(h.a)(e))),e.changeHandle=e.changeHandle.bind(Object(h.a)(Object(h.a)(e))),e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"new-room-form"},s.a.createElement("form",{onSubmit:this.submitHandle},s.a.createElement("input",{onChange:this.changeHandle,value:this.state.roomName,type:"text",placeholder:"Create room",required:!0}),s.a.createElement("button",{id:"create-room-btn",type:"submit"},"+")))}}]),t}(n.Component),E=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"switchRoom",value:function(e){this.props.switchRoom(e)}},{key:"componentDidMount",value:function(){}},{key:"renderElement",value:function(e,t){var a=this,n=e===this.props.selectedRoom?{color:"#FFC42D",fontWeight:"bold"}:{};return s.a.createElement("li",{key:t,className:"room"},s.a.createElement("a",{style:n,href:"#".concat(e),onClick:function(){return a.switchRoom(e)}}," "," ".concat(e)))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"rooms-list"},s.a.createElement("h3",null,"Available Rooms"),s.a.createElement("ul",null,this.props.roomList.map(function(t,a){return e.renderElement(t,a)})))}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({message:e.target.value})},a.handleSubmit=function(e){e.preventDefault(),a.props.sendMessage(a.state.message),a.setState({message:""})},a.state={message:""},a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("form",{className:"send-message-form",onSubmit:this.handleSubmit},s.a.createElement("input",{onChange:this.handleChange,value:this.state.message,placeholder:"Start typing... Enter to send",type:"text"}))}}]),t}(n.Component),k=a(46),_=(a(74),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).toggleLogin=function(){a.setState({registrationLinkActive:!a.state.registrationLinkActive})},a.state={username:"",password:"",error:"",password_confirmation_error:"",confirm_password:"",registrationLinkActive:!1,buttonDisabled:!0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.props.error&&this.props.error!==e.error&&this.setState({password:""}),this.state.registrationLinkActive!==t.registrationLinkActive&&(this.setState({password:"",confirm_password:"",password_confirmation_error:""}),this.props.clearErrorHandler());var a=this.state,n=a.password,s=a.confirm_password,r=a.username;this.state.registrationLinkActive?r===t.username&&s===t.confirm_password&&n===t.password||(r.length>5&&n===s&&n.length>4?this.setState({buttonDisabled:!1,password_confirmation_error:""}):(n.length<4&&""!==n?this.setState({password_confirmation_error:"Password too short"}):this.setState({password_confirmation_error:""}),n!==s&&""!==n&&""!==s&&this.setState({password_confirmation_error:"Passwords dont match"}),this.setState({buttonDisabled:!0}))):n===t.password&&r===t.username||(n.length>5&&""!==r?this.setState({buttonDisabled:!1}):this.setState({buttonDisabled:!0}))}},{key:"onChangeHandle",value:function(e){this.props.clearErrorHandler(),this.setState(Object(k.a)({},e.target.name,e.target.value))}},{key:"submitHandle",value:function(e){e.preventDefault();var t=this.state,a=t.username,n=t.password;this.state.registrationLinkActive?this.props.signup({username:a,password:n}):this.props.login({username:a,password:n})}},{key:"render",value:function(){var e=s.a.createElement(f,{disabled:this.state.buttonDisabled},"Let me in \xa0\xa0",s.a.createElement("i",{className:"fa fa-key fa-1.8x",color:"black"}));return this.state.registrationLinkActive&&(e=s.a.createElement(s.a.Fragment,null,s.a.createElement("input",{className:"input",type:"password",value:this.state.password_confirm,onChange:this.onChangeHandle.bind(this),name:"confirm_password",placeholder:"Confirm Password",required:!0}),s.a.createElement(f,{disabled:this.state.buttonDisabled},"Create Account \xa0\xa0",s.a.createElement("i",{className:"fa fa-user fa-1.8x",color:"black"})))),this.props.loading&&(e=s.a.createElement(O,null)),s.a.createElement("div",{className:"login"},s.a.createElement("h1",null,"Chat\u2022R"),s.a.createElement("form",{method:"get",onSubmit:this.submitHandle.bind(this)},s.a.createElement("input",{className:"input",type:"email",value:this.state.username,onChange:this.onChangeHandle.bind(this),name:"username",placeholder:"Email",required:!0}),s.a.createElement("input",{className:"input",type:"password",value:this.state.password,onChange:this.onChangeHandle.bind(this),name:"password",placeholder:"Password",required:!0}),e,s.a.createElement("span",{className:"error"},this.state.password_confirmation_error),s.a.createElement("span",{className:"error"},this.props.error)),s.a.createElement("small",{onClick:this.toggleLogin},this.state.registrationLinkActive?"Returning User":"Create New Account ?"))}}]),t}(n.Component)),N=a(75),O=function(){return s.a.createElement("span",{style:{display:"flex",width:"100%",justifyContent:"center"}},s.a.createElement("img",{src:N,className:"spinner",alt:"spinner"}))},j=a(15),y=a.n(j),D=a(47),C=a.n(D),H=a(48),L=a.n(H),R=function(e){return s.a.createElement("li",{className:L.a.NavigationItem},e.children)},x=function(e){var t=s.a.createElement(s.a.Fragment,null,s.a.createElement(R,{link:"/"},s.a.createElement("button",{onClick:e.logout},"Logout")));return s.a.createElement("ul",{className:C.a.NavigationItems},t)},A=a(49),T=a.n(A),B=function(e){return s.a.createElement("div",{onClick:e.click,className:T.a.DrawerToggle},s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null))},U=function(e){return s.a.createElement("header",{className:y.a.Toolbar},s.a.createElement(B,{click:e.drawerToggleClicked}),s.a.createElement("div",{className:y.a.Logo}),s.a.createElement("nav",{className:y.a.DesktopOnly},s.a.createElement(x,{isAuthenticated:e.isAuthenticated,logout:e.logout})))},M=a(9),I=a.n(M),F=a(50),P=a.n(F),q=function(e){return e.show?s.a.createElement("div",{className:P.a.Backdrop,onClick:e.click}):null},z=function(e){var t=[I.a.SideDrawer,I.a.Close];return e.visible&&(t=[I.a.SideDrawer,I.a.Open]),s.a.createElement(s.a.Fragment,null,s.a.createElement(q,{show:e.visible,click:e.toggleSideDrawer}),s.a.createElement("div",{className:t.join(" "),onClick:e.toggleSideDrawer},s.a.createElement("div",{className:I.a.Logo}),s.a.createElement("nav",null,s.a.createElement(x,{isAuthenticated:e.isAuthenticated,logout:e.logout}))))},W=a(51),J=a.n(W),K=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).updateMessages=function(e){var t=[];(t=a.state.messages).push(e),a.setState({messages:t})},a.userLoginHandle=function(e){var t=e.username,n=e.password;a.setState({loading:!0,error:""}),p.a.post("".concat(a.serverUrl,"/login"),{password:n,username:t}).then(function(e){200===e.status?a.setState({error:"",username:e.data.username}):201===e.status?a.setState({error:"Oops, not what we expected"}):202===e.status?a.setState({error:"User not found"}):a.setState({error:"Something went wrong"})}).catch(function(e){a.setState({username:null,error:"something went wrong"})}).finally(function(){return a.setState({loading:!1})})},a.userSignupHandle=function(e){var t=e.username,n=e.password;a.setState({loading:!0}),p.a.post("".concat(a.serverUrl,"/signup"),{username:t,password:n}).then(function(e){200===e.status?a.setState({error:"",username:e.data.username}):201===e.status?a.setState({error:"User already exists"}):a.setState({error:"Something went wrong"})}).catch(function(e){a.setState({username:null,error:"something went wrong"})}).finally(function(){a.setState({loading:!1})})},a.logout=function(){a.setState({messages:[],roomList:[],roomName:null,username:null,error:""})},a.showSideBar=function(){a.setState({showSideBar:!0})},a.sideDrawerToggleHandler=function(){a.setState(function(e){return{showSideBar:!e.showSideBar}})},a.clearErrorHandler=function(){a.setState({error:"",loading:!1})},a.state={messages:[],roomList:[],roomName:null,username:null,error:"",loading:!1,showSideBar:!1},a.serverUrl="/",a.sendMessageHandle=a.sendMessage.bind(Object(h.a)(Object(h.a)(a))),a.addRoomHandle=a.addRoom.bind(Object(h.a)(Object(h.a)(a))),a.switchRoomHandle=a.switchRoom.bind(Object(h.a)(Object(h.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.socket=J.a.connect(this.serverUrl),this.socket.on("new_message",function(t){e.updateMessages(t)}),this.socket.on("initialize",function(t){e.setState({roomList:t.rooms,roomName:t.currentRoom,messages:t.messages})}),this.socket.on("createRoom",function(t){e.updateRooms(t.rooms)}),this.socket.on("switchRoom",function(t){e.setState({roomName:t.roomName,messages:t.messages})})}},{key:"componentDidUpdate",value:function(e,t){this.state.username&&this.state.username!==t.username&&this.socket.emit("username",{username:this.state.username})}},{key:"switchRoom",value:function(e){this.setState({roomName:e,messages:[]}),this.socket.emit("switchRoom",{roomName:e})}},{key:"updateRooms",value:function(e){this.setState({roomList:e})}},{key:"sendMessage",value:function(e){this.socket.emit("new_message",{message:e})}},{key:"addRoom",value:function(e){var t=Object(i.a)(this.state.roomList);t.push(e),this.setState({roomList:t}),this.socket.emit("createRoom",{roomName:e})}},{key:"render",value:function(){return this.state.username?s.a.createElement("div",{className:"app"},s.a.createElement(U,{drawerToggleClicked:this.sideDrawerToggleHandler,logout:this.logout}),s.a.createElement(z,{visible:this.state.showSideBar,toggleSideDrawer:this.sideDrawerToggleHandler,logout:this.logout}),s.a.createElement("div",{className:"main-area"},s.a.createElement("section",{className:"side-section"},s.a.createElement(E,{switchRoom:this.switchRoomHandle,selectedRoom:this.state.roomName,roomList:this.state.roomList}),s.a.createElement(v,{addRoom:this.addRoomHandle})),s.a.createElement("main",{className:"main-section"},s.a.createElement(w,{messageData:this.state.messages,currentUser:this.state.username}),s.a.createElement(S,{sendMessage:this.sendMessageHandle})))):s.a.createElement(_,{loading:this.state.loading,signup:this.userSignupHandle,error:this.state.error,login:this.userLoginHandle,clearErrorHandler:this.clearErrorHandler})}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},15:function(e,t,a){e.exports={Toolbar:"Toolbar_Toolbar__2aj-k",Logo:"Toolbar_Logo__s8zh_",DesktopOnly:"Toolbar_DesktopOnly__1uL-_"}},47:function(e,t,a){e.exports={NavigationItems:"NavigationItems_NavigationItems__Sincj"}},48:function(e,t,a){e.exports={NavigationItem:"NavigationItem_NavigationItem__1Y0gB",active:"NavigationItem_active__OXcS4"}},49:function(e,t,a){e.exports={DrawerToggle:"ToggleButton_DrawerToggle__2KfFP"}},50:function(e,t,a){e.exports={Backdrop:"Backdrop_Backdrop__14PyZ"}},53:function(e,t,a){e.exports=a(105)},74:function(e,t,a){},75:function(e,t,a){e.exports=a.p+"static/media/spinner.be0d9fd5.gif"},9:function(e,t,a){e.exports={SideDrawer:"SideDrawer_SideDrawer__o0gcg",Open:"SideDrawer_Open__20umz",Close:"SideDrawer_Close__2Aas8",Logo:"SideDrawer_Logo__1nkQA"}}},[[53,1,2]]]);
//# sourceMappingURL=main.3137c2b4.chunk.js.map